{% include "header.html" %}

<!-- Page Header-->
<header
    class="masthead"
    style="background-image: url('../static/assets/img/contact-bg.jpg')"
>
    <div class="container position-relative px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <div class="page-heading">
                    {% if request.args.get('success') %}
                        <h1>Successfully sent your message</h1>
                    {% else %}
                        <h1>Contact Me</h1>
                    {% endif %}
                    <span class="subheading">Have questions? I have answers.</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Main Content-->
<main class="mb-4">
    <div class="container px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <div id="formContainer">
                    <p>
                        Want to get in touch? Fill out the form below to send me a message and
                        I will get back to you as soon as possible!
                    </p>

                    <div class="my-5">
                        <!-- Formspree Form -->
                        <form id="contactForm" name="sentMessage">
                            <div class="form-floating mb-3">
                                <input class="form-control" id="name" name="name" type="text"
                                       placeholder="Enter your name..." required />
                                <label for="name">Name</label>
                            </div>

                            <div class="form-floating mb-3">
                                <input class="form-control" id="email" name="email" type="email"
                                       placeholder="Enter your email..." required />
                                <label for="email">Email address</label>
                            </div>

                            <div class="form-floating mb-3">
                                <input class="form-control" id="phone" name="phone" type="tel"
                                       placeholder="Enter your phone number..." />
                                <label for="phone">Phone Number</label>
                            </div>

                            <div class="form-floating mb-3">
                                <textarea class="form-control" id="message" name="message"
                                          placeholder="Enter your message here..." required
                                          style="height: 12rem"></textarea>
                                <label for="message">Message</label>
                            </div>

                            <button class="btn btn-primary text-uppercase" id="submitButton" type="submit">
                                Send
                            </button>
                        </form>
                    </div>

                    <div id="formMessage" class="mt-3"></div> <!-- Success/Error message -->
                </div>
            </div>
        </div>
    </div>
</main>

<script>
    const form = document.getElementById('contactForm');
    const messageDiv = document.getElementById('formMessage');
    const formContainer = document.getElementById('formContainer');

    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = new FormData(form);

        try {
            const response = await fetch('https://formspree.io/f/xwvvygpl', {
                method: 'POST',
                body: formData,
                headers: { 'Accept': 'application/json' }
            });

            if (!response.ok) {
                const data = await response.json();
                let errorText = 'Oops! There was a problem submitting your form.';
                if (data.errors) {
                    errorText += ' ' + data.errors.map(err => err.message).join(' ');
                }
                messageDiv.innerHTML = `<div class="alert alert-danger">${errorText}</div>`;
                return;
            }

            // Success: update header and show message
            const headerH1 = document.querySelector('.page-heading h1');
            headerH1.textContent = 'Successfully sent your message';
            messageDiv.innerHTML = '<div class="alert alert-success">Thanks! Your message has been sent.</div>';
            form.reset();

            // Scroll the page to the top smoothly
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Hide the form after scrolling
            setTimeout(() => {
                formContainer.style.display = 'none';
            }, 300); // short delay to let scroll start

        } catch (error) {
            messageDiv.innerHTML = '<div class="alert alert-danger">Network error. Please try again later.</div>';
            console.error(error);
        }
    });
</script>


{% include "footer.html" %}
